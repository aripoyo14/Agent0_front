(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[523],{514:(e,t,s)=>{"use strict";s.d(t,{f7:()=>l,gf:()=>o});let r="access_token",a="token_type";function n(){return"undefined"!=typeof localStorage}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bearer";n()&&(localStorage.setItem(r,e),localStorage.setItem(a,t))}function o(){return n()?{accessToken:localStorage.getItem(r),tokenType:localStorage.getItem(a)}:{accessToken:null,tokenType:null}}},1890:(e,t,s)=>{"use strict";s.d(t,{default:()=>i});var r=s(5155),a=s(2115),n=s(5695),l=s(9323);let o=e=>{let{isOpen:t,onClose:s}=e,[n,l]=(0,a.useState)(""),[o,i]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),u=async e=>{e.preventDefault(),n&&(i(!0),setTimeout(()=>{i(!1),d(!0),setTimeout(()=>{s(),d(!1),l("")},3e3)},1500))};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"閉じる",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"メールを送信しました"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[n," にパスワードリセット用のリンクを送信しました。",(0,r.jsx)("br",{}),"メールをご確認ください。"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"パスワードリセット"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["登録済みのメールアドレスを入力してください。",(0,r.jsx)("br",{}),"パスワードリセット用のリンクをお送りします。"]})]}),(0,r.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 mb-1",children:"メールアドレス"}),(0,r.jsx)("input",{id:"reset-email",type:"email",value:n,onChange:e=>l(e.target.value),placeholder:"example@email.com",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4AA0E9] focus:border-transparent"})]}),(0,r.jsx)("button",{type:"submit",disabled:o||!n,className:"w-full bg-[#4AA0E9] text-white py-2 px-4 rounded-lg font-medium hover:bg-[#3a8fd9] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"送信中...":"リセットメールを送信"})]})]})]})}):null};function i(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)(""),[i,c]=(0,a.useState)(""),[d,u]=(0,a.useState)("idle"),[m,x]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1);async function b(s){s.preventDefault(),x(null),u("submitting");try{if(!t||!i)throw Error("メールアドレスとパスワードを入力してください");await (0,l.iD)(t,i),u("success"),setTimeout(()=>{let t=(0,l.l4)();(null==t?void 0:t.userType)==="expert"?e.push("/policy"):e.push("/dashboard")},100)}catch(e){u("error"),x(e instanceof Error?e.message:"ログインに失敗しました")}}let g="submitting"===d;return(0,r.jsxs)("div",{className:"w-full max-w-xs",children:[(0,r.jsx)("h1",{className:"text-center text-xl font-bold text-white mb-12 tracking-[0.25em]",children:"METI Picks"}),(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4","aria-describedby":m?"form-error":void 0,children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"email",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["メールアドレス",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",inputMode:"email",required:!0,placeholder:"メールアドレスをご入力ください",value:t,onChange:e=>s(e.target.value),className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"password",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["パスワード",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,placeholder:"パスワードをご入力ください",value:i,onChange:e=>c(e.target.value),className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"}),(0,r.jsx)("div",{className:"mt-2 text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>p(!0),className:"text-[10px] text-white/80 hover:text-white underline decoration-white/50 hover:decoration-white transition-colors",children:"パスワードをお忘れですか？"})})]}),m&&(0,r.jsx)("p",{id:"form-error",className:"text-[10px] text-blue-100 bg-blue-500/15 rounded px-2 py-1 text-center",children:m}),(0,r.jsx)("div",{className:"pt-6 flex justify-center",children:(0,r.jsxs)("button",{type:"submit",disabled:g,className:"inline-flex items-center justify-center gap-1 rounded-full bg-white/90 backdrop-blur-sm px-4 py-2 text-[#4AA0E9] text-sm font-medium transition-all hover:bg-white hover:shadow-lg disabled:opacity-60","aria-busy":g,children:[g?"送信中…":"ログイン",(0,r.jsx)("span",{"aria-hidden":!0,className:"inline-block select-none text-base text-[#4AA0E9]",children:"→"})]})})]}),(0,r.jsx)(o,{isOpen:h,onClose:()=>p(!1)})]})}},2523:(e,t,s)=>{Promise.resolve().then(s.bind(s,3704)),Promise.resolve().then(s.bind(s,1890))},2956:(e,t,s)=>{"use strict";s.d(t,{n:()=>n});var r=s(514);let a=s(7358).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";async function n(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:n="GET",body:l,headers:o={},auth:i=!1,signal:c}=s,d={...o};if(l instanceof FormData||(d["Content-Type"]="application/json"),i){let{accessToken:e,tokenType:t}=(0,r.gf)();e&&(d.Authorization="".concat(t||"Bearer"," ").concat(e))}let u=await fetch("".concat(a).concat(e),{method:n,headers:d,body:l instanceof FormData?l:null!=l?JSON.stringify(l):void 0,credentials:"include",signal:c}),m=(null==(t=u.headers.get("content-type"))?void 0:t.includes("application/json"))?await u.json().catch(()=>null):null;if(!u.ok)throw Error((null==m?void 0:m.detail)||(null==m?void 0:m.message)||"Request failed: ".concat(u.status));return m}},3704:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var r=s(5155),a=s(2115);function n(e){let{scale:t=1,vwRatio:s=.9,maxWidthPx:n=1100}=e,[l,o]=(0,a.useState)({width:0,height:0,top1:0,top2:0,top3:0});(0,a.useEffect)(()=>{let e=()=>{let e=window.innerWidth,r=window.innerHeight,a=Math.min(e*s,n)*t,l=.35917765074963215*a,i=Math.max(0,r-l);o({width:a,height:l,top1:0,top2:0+l,top3:i})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[n,t,s]);let i={left:"50%",transform:"translateX(-50%)",width:l.width,height:l.height,borderRadius:706.9231};return(0,r.jsxs)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0",children:[(0,r.jsx)("div",{className:"absolute",style:{...i,top:l.top1,background:"linear-gradient(90deg, rgba(135,196,247,0.4) 0%, rgba(160,199,217,0) 79%)"}}),(0,r.jsx)("div",{className:"absolute",style:{...i,top:l.top2,background:"linear-gradient(270deg, rgba(143,184,234,0.4) 0%, rgba(160,199,217,0) 78%)"}}),(0,r.jsx)("div",{className:"absolute",style:{...i,top:l.top3,background:"linear-gradient(90deg, rgba(142,184,216,0.3) 0%, rgba(160,199,217,0) 79%)"}})]})}},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},9323:(e,t,s)=>{"use strict";s.d(t,{iD:()=>l,l4:()=>n});var r=s(2956),a=s(514);function n(){let e,t=(0,a.gf)();if(!t)return null;if("string"==typeof t)e=t;else{if(!t||"object"!=typeof t||!("accessToken"in t)||"string"!=typeof t.accessToken||!t.accessToken)return null;e=t.accessToken}try{let t,s=e.split(".")[1];if(!s)return null;let r=s.replace(/-/g,"+").replace(/_/g,"/"),a=r.padEnd(r.length+(4-(r.length%4||0))%4,"="),n=atob(a),l=JSON.parse(n);return t="expert"===l.user_type?"contributor":"user"===l.user_type?"staff":"contributor",{userId:l.sub,userType:l.user_type,role:t}}catch(e){return null}}async function l(e,t){let s=await (0,r.n)("/api/auth/login",{method:"POST",body:{email:e,password:t}});(0,a.f7)(s.access_token,s.token_type)}}}]);