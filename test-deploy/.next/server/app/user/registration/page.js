(()=>{var e={};e.id=424,e.ids=[424],e.modules={440:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(1658);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1135:()=>{},1290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d});var r=s(5239),n=s(8088),a=s(8170),i=s.n(a),l=s(893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d={children:["",{children:["user",{children:["registration",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2206)),"/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/app/user/registration/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,4431)),"/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/app/user/registration/page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/user/registration/page",pathname:"/user/registration",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2206:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>i});var r=s(7413),n=s(8477),a=s(8112);let i={title:"User-Registration"};function l(){return(0,r.jsxs)("main",{className:"relative min-h-screen w-full bg-gradient-to-t from-[#b4d9d6] to-[#58aadb] overflow-hidden",children:[(0,r.jsx)(a.default,{scale:.8}),(0,r.jsx)("div",{className:"relative flex min-h-screen items-center justify-center px-4",children:(0,r.jsx)(n.default,{})})]})}},2234:(e,t,s)=>{"use strict";s.d(t,{n:()=>a});var r=s(8744);let n=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";async function a(e,t={}){let{method:s="GET",body:i,headers:l={},auth:o=!1,signal:d}=t,c={...l};if(i instanceof FormData||(c["Content-Type"]="application/json"),o){let{accessToken:e,tokenType:t}=(0,r.gf)();e&&(c.Authorization=`${t||"Bearer"} ${e}`)}let x=await fetch(`${n}${e}`,{method:s,headers:c,body:i instanceof FormData?i:null!=i?JSON.stringify(i):void 0,credentials:"include",signal:d}),p=x.headers.get("content-type")?.includes("application/json")?await x.json().catch(()=>null):null;if(!x.ok)throw Error(p?.detail||p?.message||`Request failed: ${x.status}`);return p}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3088:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6346,23)),Promise.resolve().then(s.t.bind(s,7924,23)),Promise.resolve().then(s.t.bind(s,5656,23)),Promise.resolve().then(s.t.bind(s,99,23)),Promise.resolve().then(s.t.bind(s,8243,23)),Promise.resolve().then(s.t.bind(s,8827,23)),Promise.resolve().then(s.t.bind(s,2763,23)),Promise.resolve().then(s.t.bind(s,7173,23))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3360:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6444,23)),Promise.resolve().then(s.t.bind(s,6042,23)),Promise.resolve().then(s.t.bind(s,8170,23)),Promise.resolve().then(s.t.bind(s,9477,23)),Promise.resolve().then(s.t.bind(s,9345,23)),Promise.resolve().then(s.t.bind(s,2089,23)),Promise.resolve().then(s.t.bind(s,6577,23)),Promise.resolve().then(s.t.bind(s,1307,23))},3857:()=>{},3867:(e,t,s)=>{"use strict";s.d(t,{C:()=>a,V:()=>n});var r=s(2234);async function n(e){return(0,r.n)("/api/mfa/setup-complete",{method:"POST",body:e})}async function a(e){return(await (0,r.n)(`/api/mfa/generate-qr/${e}`)).qr_code}},3873:e=>{"use strict";e.exports=require("path")},4420:(e,t,s)=>{Promise.resolve().then(s.bind(s,8112)),Promise.resolve().then(s.bind(s,8477))},4431:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>o});var r=s(7413),n=s(997),a=s.n(n),i=s(5930),l=s.n(i);s(1135);let o={title:"METI Picks - 人物プロフィールシステム",description:"経済産業省の人物データベースと専門家プロフィール管理システム"};function d({children:e}){return(0,r.jsxs)("html",{lang:"ja",children:[(0,r.jsxs)("head",{children:[(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}),(0,r.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap",rel:"stylesheet"})]}),(0,r.jsx)("body",{className:`${a().variable} ${l().variable} antialiased`,children:e})]})}},6007:(e,t,s)=>{Promise.resolve().then(s.bind(s,8610)),Promise.resolve().then(s.bind(s,8491))},7009:()=>{},8112:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/components/blocks/BackgroundEllipses.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/components/blocks/BackgroundEllipses.tsx","default")},8477:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/components/blocks/UserRegistrationForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/ikedasayaka/Desktop/frontend/Agent0_front/src/components/blocks/UserRegistrationForm.tsx","default")},8491:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(687),n=s(3210),a=s(6189),i=s(2234);async function l(e){return(0,i.n)("/api/users/register",{method:"POST",body:e})}var o=s(3867),d=s(474);function c(){let e=(0,a.useRouter)(),[t,s]=(0,n.useState)("input"),[i,c]=(0,n.useState)({last_name:"",first_name:"",extension:"",direct_phone:"",department_id:0,position_id:0,email:"",password:"",password_confirm:""}),[x,p]=(0,n.useState)([]),[u,m]=(0,n.useState)([]),[h,b]=(0,n.useState)(null),[g,f]=(0,n.useState)(""),[w,v]=(0,n.useState)("idle"),[j,y]=(0,n.useState)(null),[k,N]=(0,n.useState)(""),[_,P]=(0,n.useState)(!1);(0,n.useCallback)(async()=>{if(h)try{let e=await (0,o.C)(h.user_id);f(e)}catch(e){console.error("QRコード生成エラー:",e)}},[h]);let C=e=>{let{name:t,value:s}=e.target;c(e=>({...e,[t]:s}))},A=async e=>{if(e.preventDefault(),y(null),i.password!==i.password_confirm)return void y("パスワードが一致しません");if(0===i.department_id)return void y("部署を選択してください");if(0===i.position_id)return void y("役職を選択してください");P(!0);try{let{password_confirm:e,...t}=i,r=await l(t);console.log("登録成功:",r),b(r),s("mfa-setup"),v("idle")}catch(e){console.error("登録エラー:",e),v("error"),y(e instanceof Error?e.message:"登録に失敗しました")}finally{P(!1)}};async function q(){if(h&&6===k.length)try{v("submitting"),await (0,o.V)({user_id:h.user_id,totp_secret:h.totp_secret,backup_codes:h.backup_codes}),s("completion"),v("idle")}catch(e){console.error("MFA設定エラー:",e),y(e instanceof Error?e.message:"MFA設定に失敗しました"),v("idle")}}return"input"===t?(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsx)("h1",{className:"text-center text-xl font-bold text-white mb-12 tracking-[0.25em]",children:"ユーザー 新規登録"}),(0,r.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"last_name",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["姓",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"last_name",name:"last_name",type:"text",required:!0,placeholder:"姓を入力してください",value:i.last_name,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"first_name",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["名",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"first_name",name:"first_name",type:"text",required:!0,placeholder:"名を入力してください",value:i.first_name,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"extension",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["内線番号",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"任意"})]}),(0,r.jsx)("input",{id:"extension",name:"extension",type:"text",placeholder:"内線番号を入力してください",value:i.extension,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"direct_phone",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["直通番号",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"任意"})]}),(0,r.jsx)("input",{id:"direct_phone",name:"direct_phone",type:"text",placeholder:"直通番号を入力してください",value:i.direct_phone,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"department_id",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["部署",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsxs)("select",{id:"department_id",name:"department_id",required:!0,value:i.department_id,onChange:e=>c(t=>({...t,department_id:parseInt(e.target.value)})),className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50",children:[(0,r.jsx)("option",{value:0,children:0===x.length?"データ読み込み中...":"部署を選択してください"}),x.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name,e.section?` - ${e.section}`:""]},e.id))]}),0===x.length&&(0,r.jsx)("p",{className:"text-[10px] text-blue-100 bg-blue-500/15 rounded px-2 py-1 mt-1",children:"部署データを読み込み中..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"position_id",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["役職",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsxs)("select",{id:"position_id",name:"position_id",required:!0,value:i.position_id,onChange:e=>c(t=>({...t,position_id:parseInt(e.target.value)})),className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50",children:[(0,r.jsx)("option",{value:0,children:0===u.length?"データ読み込み中...":"役職を選択してください"}),u.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),0===u.length&&(0,r.jsx)("p",{className:"text-[10px] text-blue-100 bg-blue-500/15 rounded px-2 py-1 mt-1",children:"役職データを読み込み中..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"email",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["メールアドレス",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,placeholder:"メールアドレスを入力してください",value:i.email,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"password",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["パスワード",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,placeholder:"8文字以上で入力してください",value:i.password,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"password_confirm",className:"flex items-center gap-1 text-white text-xs font-medium mb-1",children:["パスワード確認",(0,r.jsx)("span",{className:"inline-block rounded bg-[#4aa0e9] px-1 py-0.5 text-[10px] font-bold text-white",children:"必須"})]}),(0,r.jsx)("input",{id:"password_confirm",name:"password_confirm",type:"password",autoComplete:"new-password",required:!0,placeholder:"パスワードを再入力してください",value:i.password_confirm,onChange:C,className:"block w-full rounded-lg bg-white/90 backdrop-blur-sm px-2 py-2 text-[#333] text-sm outline-none border-0 focus:bg-white focus:ring-1 focus:ring-white/50 placeholder:text-xs placeholder:text-[#999]"})]}),j&&(0,r.jsx)("p",{id:"form-error",className:"text-[10px] text-blue-100 bg-blue-500/15 rounded px-2 py-1 text-center",children:j}),"success"===w&&(0,r.jsx)("p",{className:"text-[10px] text-green-100 bg-green-500/15 rounded px-2 py-1 text-center",children:"登録が完了しました。ログインページに遷移します..."}),(0,r.jsx)("div",{className:"pt-6 flex justify-center",children:(0,r.jsxs)("button",{type:"submit",disabled:_,className:"inline-flex items-center justify-center gap-1 rounded-full bg-white/90 backdrop-blur-sm px-4 py-2 text-[#4AA0E9] text-sm font-medium transition-all hover:bg-white hover:shadow-lg disabled:opacity-60","aria-busy":_,children:[_?"送信中…":"登録",(0,r.jsx)("span",{"aria-hidden":!0,className:"inline-block select-none text-base text-[#4AA0E9]",children:"→"})]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>e.push("/login"),className:"text-[10px] text-white/80 hover:text-white underline decoration-white/50 hover:decoration-white transition-colors",children:"既にアカウントをお持ちですか？ログイン"})})]})]}):"mfa-setup"===t&&h?(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center mb-6 text-white",children:"二段階認証の設定"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"ステップ1: 認証アプリをインストール"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Google Authenticator、Microsoft Authenticator、またはAuthyをインストールしてください"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"ステップ2: QRコードをスキャン"}),g?(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)(d.default,{src:g,alt:"MFA QR Code",width:192,height:192,className:"w-48 h-48"})}):(0,r.jsx)("div",{className:"bg-gray-100 w-48 h-48 mx-auto flex items-center justify-center text-gray-500",children:"QRコード生成中..."}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-4",children:[(0,r.jsx)("p",{children:"手動入力用の秘密鍵:"}),(0,r.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:h.totp_secret})]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"ステップ3: 6桁の認証コードを入力"}),(0,r.jsx)("input",{type:"text",placeholder:"000000",maxLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-center text-lg tracking-widest",value:k,onChange:e=>N(e.target.value.replace(/\D/g,""))})]}),(0,r.jsx)("button",{onClick:q,disabled:6!==k.length||_,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50",children:_?"確認中...":"認証コードを確認"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"バックアップコード"}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"認証アプリが使えない場合の緊急用コード:"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:h.backup_codes.map((e,t)=>(0,r.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-center",children:e},t))})]})]})]}):"completion"===t?(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-8 text-center",children:[(0,r.jsx)("div",{className:"text-green-500 text-6xl mb-4",children:"✅"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"設定完了！"}),(0,r.jsxs)("p",{className:"text-gray-600 mb-6",children:["二段階認証の設定が完了しました。",(0,r.jsx)("br",{}),"アカウントが有効化され、セキュリティが大幅に向上しました。"]}),(0,r.jsx)("button",{onClick:()=>e.push("/login"),className:"bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700",children:"ログイン画面へ"})]})}):null}},8610:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var r=s(687),n=s(3210);function a({scale:e=1,vwRatio:t=.9,maxWidthPx:s=1100}){let[a,i]=(0,n.useState)({width:0,height:0,top1:0,top2:0,top3:0}),l={left:"50%",transform:"translateX(-50%)",width:a.width,height:a.height,borderRadius:706.9231};return(0,r.jsxs)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0",children:[(0,r.jsx)("div",{className:"absolute",style:{...l,top:a.top1,background:"linear-gradient(90deg, rgba(135,196,247,0.4) 0%, rgba(160,199,217,0) 79%)"}}),(0,r.jsx)("div",{className:"absolute",style:{...l,top:a.top2,background:"linear-gradient(270deg, rgba(143,184,234,0.4) 0%, rgba(160,199,217,0) 78%)"}}),(0,r.jsx)("div",{className:"absolute",style:{...l,top:a.top3,background:"linear-gradient(90deg, rgba(142,184,216,0.3) 0%, rgba(160,199,217,0) 79%)"}})]})}},8744:(e,t,s)=>{"use strict";s.d(t,{f7:()=>r,gf:()=>n});function r(e,t="bearer"){}function n(){return{accessToken:null,tokenType:null}}},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,468,658,598],()=>s(1290));module.exports=r})();